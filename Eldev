; -*- mode: emacs-lisp; lexical-binding: t; no-byte-compile: t -*-

;; Explicitly set main file
(setf eldev-project-main-file "vulpea-journal.el")

(eldev-require-version "0.10.3")

(eldev-use-package-archive 'gnu)
(eldev-use-package-archive 'melpa-unstable)

;; Allow to load test helpers
(eldev-add-loading-roots 'test "test")

;; Tell checkdoc not to demand two spaces after a period.
(setq sentence-end-double-space nil)

;;; Local/VC Dependency Resolution
;;
;; Use local dependencies when available (for development), otherwise
;; fetch from GitHub. Local paths can be set via environment variables
;; or detected automatically in ~/Developer/.

(defun vulpea-journal--use-local-or-vc (name env-var default-path github-repo)
  "Use local dependency NAME if available, otherwise fetch from GitHub.
NAME is ignored for local deps (Eldev infers from directory).
ENV-VAR is the environment variable to check for path override.
DEFAULT-PATH is the default local path relative to HOME.
GITHUB-REPO is the GitHub repo in \"user/repo\" format."
  (let* ((env-path (getenv env-var))
         (default-full-path (expand-file-name default-path (getenv "HOME")))
         (local-path (or env-path
                         (and (file-exists-p default-full-path) default-full-path))))
    (if local-path
        (eldev-use-local-dependency local-path)
      (eldev-use-vc-repository 'github github-repo))))

;; vulpea - note management library (required)
(vulpea-journal--use-local-or-vc 'vulpea "VULPEA_PATH" "Developer/vulpea" "d12frosted/vulpea")

;; vui.el - declarative UI library (required)
(vulpea-journal--use-local-or-vc 'vui "VUI_PATH" "Developer/vui.el" "d12frosted/vui.el")
